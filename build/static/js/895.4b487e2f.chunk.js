"use strict";(self.webpackChunkespressit_social_media_app=self.webpackChunkespressit_social_media_app||[]).push([[895],{895:function(e,t,r){r.r(t),r.d(t,{default:function(){return f}});var n=r(4165),a=r(5861),i=r(885),s=r(2791),o=r(3002),u=r(9062),c=r(2426),l=r(4453),d=r(184),p=r(865),f=function(e){var t=e.currentUser,r=e.toggleEditProfilePage,f=e.returnToMainAfterProfileEdit,m=t,v=(0,s.useState)({user:{comments:[],displayName:"",favoritePosts:[],posts:[],imgURL:"",uid:"",username:""}}),h=(0,i.Z)(v,2),g=h[0],y=h[1],b=(0,s.useState)(),x=(0,i.Z)(b,2),w=x[0],N=x[1],Z=(0,c.ZF)({apiKey:"AIzaSyDsPecBa3Ch5uDw4UzHiJWAjKEYOKCrNdA",authDomain:"espressit.firebaseapp.com",projectId:"espressit",storageBucket:"espressit.appspot.com",messagingSenderId:"1094129721341",appId:"1:1094129721341:web:dc2bdc0a2b322504b04394"}),U=(0,u.ad)(Z),j=(0,l.cF)(Z);(0,s.useEffect)((function(){!function(){var e=(0,a.Z)((0,n.Z)().mark((function e(){var t,r,a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,u.JU)(U,"users",m.uid),e.next=3,(0,u.QT)(t);case 3:(r=e.sent).exists()&&(a=r.data(),y({user:{comments:a.comments,displayName:a.displayName,favoritePosts:a.favoritePosts,posts:a.posts,imgURL:a.imgURL,uid:a.uid,username:a.username}}));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[]);var C=/^[a-z]{3,12}$|^[a-z]{3,12}\d{2,4}$/g,k=new p,P=function(e,t){"username-edit-input"!==e.id||(e.validity.valueMissing?(t.textContent="If you are updating your username this input cannot be blank :)",t.classList.add("error","error-active")):e.value.match(C)?k.isProfane(e.value)&&(t.textContent="We don't accept profanity in usernames, sorry :(",t.classList.add("error","error-active")):(t.textContent="Your username does not match our rules of: 1) 3-12 lowercase letters or 3-12 lowercase letters and 2-4 numbers, 2) no symbols, 3) no uppercase characters",t.classList.add("error","error-active")))},R=function(e){e.length>2&&(!function(){var t=(0,a.Z)((0,n.Z)().mark((function t(){var r;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=(0,u.JU)(U,"users",m.uid),t.next=3,(0,u.r7)(r,{username:e});case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()(),f())};function L(){return S.apply(this,arguments)}function S(){return(S=(0,a.Z)((0,n.Z)().mark((function e(){var t,r,a,i;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,u.JU)(U,"users",m.uid),e.next=3,(0,u.QT)(t);case 3:(r=e.sent).exists()&&"https://firebasestorage.googleapis.com"===(a=r.data()).imgURL.slice(0,38)&&(i=(0,l.iH)(j,a.imgURLRef),(0,l.oq)(i).then((function(){(0,u.r7)(t,{imgURLRef:""})})).catch((function(e){alert("we were unable to remove your previous profile picture and therefor did not upload your new picture, please try again later")})));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var I=function(){void 0!==typeof w&&"undefined"!==typeof w&&(void 0===typeof w&&"undefined"===typeof w||(L(),function(){var e=(0,a.Z)((0,n.Z)().mark((function e(){var t,r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=(0,l.cF)(),r=(0,l.iH)(t,"images/".concat(w.name)),(0,l.KV)(r,w).then((function(e){(0,l.Jt)((0,l.iH)(t,"images/".concat(w.name))).then((function(e){var t=(0,u.JU)(U,"users",m.uid);(0,u.r7)(t,{imgURL:e,imgURLRef:"images/".concat(w.name)}),f()})).catch((function(e){alert("your profile picture was uploaded to the database, but we were not able to save it to your profile, please try again later")}))})).catch((function(){alert("your image was not uploaded to the server, please try again later")}));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()))},J=function(){var e=(0,a.Z)((0,n.Z)().mark((function e(){var t,r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,o.v0)(),r=t.currentUser,e.next=4,L();case 4:return e.next=6,(0,u.oe)((0,u.JU)(U,"users",m.uid)).then((function(){})).catch((function(e){alert("We were not able to remove your posts, comments, etc; please reach out to dutsandrew@gmail.com to resolve this issue")}));case 6:return e.next=8,(0,o.h8)(r).then((function(){})).catch((function(e){alert("We were not able to delete your account, please try again later!")}));case 8:f(),window.location.reload();case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,d.jsxs)("form",{className:"edit-profile-form",onSubmit:function(e){e.preventDefault();var t=document.getElementById("username-edit-input"),r=document.querySelectorAll(".error-active").length;if(0!==t.value.length){if(0!==r)return;if(!t.validity.valid||!t.value.match(C))return void P(t,t.nextSibling);for(var n=0;n<t.value.length;n++){var a=t.value.slice(n);if(k.isProfane(a)){var i=document.querySelector("#username-edit-input-error");if(i)return i.textContent="We don't accept profanity in usernames, sorry :(",void i.classList.add("error","error-active")}}R(t.value)}void 0!==w&&I()},children:[(0,d.jsx)("button",{type:"button",className:"return-to-main-page-button",onClick:function(){r()},children:"Return To Home"}),(0,d.jsxs)("fieldset",{className:"edit-profile-fieldset",children:[(0,d.jsx)("legend",{className:"edit-profile-legend",children:"Profile Information:"}),(0,d.jsx)("label",{htmlFor:"user-name",className:"edit-profile-label",children:"**Username:"}),(0,d.jsx)("input",{id:"username-edit-input",name:"user-name",className:"edit-profile-input",placeholder:g.user.username?g.user.username:"anonymous",onChange:function(e){e.preventDefault();var t=e.target,r=t.nextSibling;t&&r&&("username-edit-input"===t.id&&t.validity.valid&&t.value.match(C)&&!k.isProfane(t.value)?(r.textContent="",r.className="error"):P(t,r))},"data-testid":"username"}),(0,d.jsx)("p",{id:"username-edit-input-error",className:"error-msg"}),(0,d.jsx)("label",{htmlFor:"profile-picture",className:"edit-profile-label",children:"Profile Picture:"}),(0,d.jsx)("input",{id:"profile-picture-edit-input",className:"edit-profile-input",type:"file",onChange:function(e){N(null===e||void 0===e?void 0:e.target.files[0])},alt:"user profile picture",accept:"image/*"}),(0,d.jsx)("p",{id:"profile-picture-input-error",className:"error-msg"}),(0,d.jsx)("button",{type:"submit",className:"submit-profile-button",children:"Submit Information"})]}),(0,d.jsxs)("fieldset",{className:"edit-profile-fieldset",children:[(0,d.jsx)("legend",{className:"edit-profile-legend",children:"Danger Zone"}),(0,d.jsx)("button",{type:"button",className:"delete-account-button",onClick:J,children:"Delete Account"}),(0,d.jsx)("button",{type:"button",className:"remove-data-button",onClick:function(){var e=(0,u.JU)(U,"users",m.uid);(0,u.r7)(e,{comments:[],favoritePosts:[],posts:[]})},children:"Remove all Contributions"})]})]})}}}]);
//# sourceMappingURL=895.4b487e2f.chunk.js.map